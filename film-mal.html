 <!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Filmvisning</title>

   <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://static.wixstatic.com/media/fd2fb2_39376e4ee55b460ab7a3ebbfcf35fef7~mv2.png" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
* { margin: 0; padding: 0; box-sizing: border-box; }
* { margin: 0; padding: 0; box-sizing: border-box; }
* { margin: 0; padding: 0; box-sizing: border-box; }
* { margin: 0; padding: 0; box-sizing: border-box; }
/* Grunnoppsett */
body { background: #000; font-family: Arial, sans-serif; overflow: hidden; }

.container { position: relative; width: 100vw; height: 100vh; overflow: hidden; }

video {
  position: absolute;
  inset: 0;            /* dekker hele containeren */
  width: 100%;
  height: 100%;
  object-fit: contain; /* skalerer uten √• klippe */
  background: black;
  z-index: 1;
}




/* Br√∏dtekst-font */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400&display=swap');

video::cue {
  font-family: 'Inter', sans-serif;
  font-size: 26px !important;
  font-weight: 300;
  color: #ffffff;
  background: none !important;

  /* Tynn outline */
  text-shadow:
     -1px -1px 0 #000,
      1px -1px 0 #000,
     -1px  1px 0 #000,
      1px  1px 0 #000;

  /* üî• disse to gj√∏r teksten IKKE klumpete */
  letter-spacing: 0.5px;   /* mer luft mellom bokstavene */
  line-height: 1.45;       /* mer luft mellom linjene */

  white-space: pre-wrap;
  bottom: 8%;
}




/* UI container */
.ui {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  opacity: 1;
  transition: opacity 0.5s ease;
  z-index: 10;
}

.ui.hidden { opacity: 0; pointer-events: none; }

.ui:not(.hidden) .top-bar,
.ui:not(.hidden) .controls,
.ui:not(.hidden) .progress-container,
.ui:not(.hidden) .caption-menu {
  pointer-events: auto;
}

/* √òverste bar med fade */
.top-bar {
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  padding: 10px 20px;
  background: linear-gradient(to bottom, rgb(0, 0, 0), rgba(0, 0, 0, 0));
  display: flex;
  align-items: center;
}

/* Tilbakeknapp */
.back-button { background: none; border: none; cursor: pointer; }
.back-button img { width: 50px; height: 50px; }

/* Kontroller nederst */
.controls {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  display: flex;
  justify-content: space-between; /* venstre - midten - h√∏yre */
  align-items: center;
  padding: 15px 20px;
  background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0) 90%);
}

.left-controls,
.right-controls {
  display: flex;
  gap: 25px; /* √òkt mellomrom mellom lyd, undertekst og fullskjerm */
  align-items: center;
}

.center-controls {
  position: absolute;
  left: 50%;
  transform: translateX(-50%); /* s√∏rger for at play/pause er helt i midten av skjermen */
  display: flex;
  align-items: center;
  gap: 30px; /* mellomrom mellom rewind - play - forward */
}

.btn { background: none; border: none; cursor: pointer; }
.btn img { width: 32px; }

/* Progress bar */
.progress-container {
  position: absolute;
  bottom: 75px;
  left: 0;
  width: 100%;
  display: flex;
  padding: 0 20px;
  z-index: 12;
}

.progress {
  flex: 1;
  height: 6px;
  background: #333;
  border-radius: 5px;
  position: relative;
  cursor: pointer;
}

.progress:hover { height: 10px; }

.progress-filled {
  width: 0%;
  height: 100%;
  background: #0fddcb;
  border-radius: 5px;
}

.thumb {
  position: absolute;
  top: 50%;
  width: 12px;
  height: 12px;
  background: #fff;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  cursor: pointer;
  z-index: 13;
}

.time-display {
  position: absolute;
  bottom: 87px;
  right: 20px;
  color: #fff;
  font-size: 14px;
  z-index: 12;
}

/* Undertekst- og lydmeny */
.caption-menu {
  position: absolute;
  bottom: 120px;
  right: 20px; /* flyttet til h√∏yre */
  background: rgba(9, 27, 30, 0.95);
  border-radius: 10px;
  padding: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
  display: none;
  min-width: 180px;
  z-index: 10000;
}


.caption-menu strong {
  display: block;
  margin: 8px 0 5px;
  font-size: 14px;
  font-weight: bold;
  color: #fff;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 4px;
}

.caption-menu button {
  display: block;
  width: 100%;
  padding: 8px 12px;
  margin: 2px 0;
  background-color: transparent;
  color: #ddd;
  border: none;
  text-align: left;
  font-size: 14px;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s ease;
}

.caption-menu button:hover,
.caption-menu button.active {
  background-color: #0fddcb;
  color: #000;
  font-weight: bold;
}

.watermark {
  position: absolute;  /* f√∏lger container, ikke skjermen */
  top: 20px;
  right: 20px;
  width: 60px;
  z-index: 1000000; /* over video og UI */
  pointer-events: none; /* gj√∏r at den ikke blokkerer klikk */
}

/* Filmtittel */
.movie-title {
  position: absolute;
  bottom: 100px;
  left: 30px;
  color: white;
  font-size: 28px;
  font-weight: bold;
  text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.8);
  z-index: 12;
}

/* Loading spinner */
.loading-spinner {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 60px;
  height: 60px;
  margin: -30px 0 0 -30px;
  border: 6px solid #333;
  border-top: 6px solid #00FFCC;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  z-index: 10000;
  display: none;
}

@keyframes spin { to { transform: rotate(360deg); } }

/* Preview-boks */
.preview-box {
  position: absolute;
  bottom: 120px;
  width: 240px;
  height: 135px;
  background: #000;
  border: 2px solid #0fddcb;
  border-radius: 10px;
  overflow: hidden;
  display: none;
  z-index: 20;
  pointer-events: none;
  box-shadow: 0 4px 12px rgba(0,0,0,0.6);
  text-align: center;
}

.preview-box img { width: 100%; height: auto; display: block; }

.preview-time {
  color: #fff;
  font-size: 14px;
  font-weight: bold;
  padding: 4px 0;
  background: rgba(0,0,0,0.6);
  position: absolute;
  bottom: 0;
  width: 100%;
}

/* Resume overlay */
.resume-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.7);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 999999;
}

.resume-box {
  background: none;
  padding: 30px;
  border-radius: 12px;
  text-align: center;
  color: white;
}

.resume-box p { font-size: 18px; margin-bottom: 20px; }

.resume-buttons {
  display: flex;
  justify-content: center;
  gap: 20px;
}

.resume-buttons button {
  padding: 10px 20px;
  font-size: 16px;
  font-weight: bold;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.2s;
}

/* Mini-player modus */
.miniplayer {
  position: fixed !important;
  width: 320px !important;
  height: 180px !important;
  bottom: 20px;
  right: 20px;
  z-index: 99999 !important;
  cursor: move;
  border: 2px solid #0fddcb;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.7);
  background: black;
}

#continueBtn { background: #0fddcb; color: #000; }
#continueBtn:hover { background: #0bbba5; }

#restartBtn { background: #444; color: #fff; }
#restartBtn:hover { background: #666; }

.like-btn {
  background: none;
  border: none;
  color: #fff;
  font-size: 18px;       /* Litt st√∏rre tekst */
  font-weight: bold;     /* Fet skrift */
  cursor: pointer;
  padding: 10px 20px;
  border-radius: 50px;   /* Gj√∏r knappen "pill-formet" */
  transition: all 0.3s ease;
}

.like-btn:hover {
  background: rgba(255, 255, 255, 0.15); /* Lys rund bakgrunn */
  color: #0fddcb;  /* Endre tekstfargen ved hover */
}

.subtitle-overlay {
  position: absolute;
  bottom: 5%;
  width: 100%;
  text-align: center;
  pointer-events: none;
  z-index: 5;
  font-size: 28px;
  font-weight: 600;
  color: #FFFFFF;
  text-shadow:
    1px 1px 2px rgba(0,0,0,0.8),
   -1px -1px 2px rgba(0,0,0,0.8),
    1px -1px 2px rgba(0,0,0,0.8),
   -1px 1px 2px rgba(0,0,0,0.8);
  line-height: 1.3;
  white-space: pre-wrap;
  transition: bottom 0.5s ease; /* smooth animasjon */
}

.subtitle-overlay.subtitle-up {
  bottom: 15%; /* flytter opp n√•r kontroller vises */
}

/* UI container (kontroller) */
#ui {
  position: absolute;
  bottom: 0;
  width: 100%;
  z-index: 10; /* H√∏yere enn underteksten */
}

/* ================= FORBEDRET MOBILVENNLIGHET ================= */

@media (max-width: 768px) {

  body { overflow: hidden; }

  /* Video fyller skjermen korrekt */
  video {
    object-fit: cover;
    height: 100vh;
    width: 100vw;
  }

  /* Mindre toppbar */
  .top-bar {
    padding: 6px 12px;
  }

  .top-bar img {
    width: 34px;
    height: 34px;
  }

  /* Tittel */
  .movie-title {
    font-size: 16px;
    bottom: 70px;
    left: 12px;
  }

  /* Kontroller */
  .controls {
    padding: 8px 10px;
    justify-content: space-between;
  }

  .center-controls .btn img,
  .left-controls .btn img,
  .right-controls .btn img {
    width: 24px;
  }

  /* Like-knapp ‚Äì skjul p√• mobil (for stor) */
  .like-btn {
    font-size: 14px;
    padding: 6px 10px;
  }

  @media (orientation: landscape) {
    .like-btn { display: none; }
  }

  /* Progress bar */
  .progress-container {
    bottom: 58px;
    padding: 0 10px;
  }

  .progress {
    height: 5px;
  }

  .thumb {
    width: 10px;
    height: 10px;
  }

  .time-display {
    font-size: 12px;
    bottom: 70px;
    right: 10px;
  }

  /* Undertekster */
  video::cue,
  .subtitle-overlay {
    font-size: 17px !important;
    bottom: 13% !important;
  }

  .subtitle-overlay.subtitle-up {
    bottom: 22% !important;
  }

  /* Caption-meny */
  .caption-menu {
    right: 10px;
    bottom: 120px;
    min-width: 140px;
  }

  .caption-menu button {
    font-size: 12px;
    padding: 6px 8px;
  }

  /* Fullscreen */
  #fullscreenBtn img {
    width: 28px;
  }

  /* Vannmerke */
  .watermark {
    width: 32px;
    top: 8px;
    right: 8px;
  }
}

/* iPhone SE / veldig sm√• skjermer */
@media (max-width: 420px) {
  .movie-title {
    font-size: 14px;
    bottom: 64px;
  }

  video::cue,
  .subtitle-overlay {
    font-size: 15px !important;
    bottom: 11% !important;
  }

  .subtitle-overlay.subtitle-up {
    bottom: 20% !important;
  }
}

    /* ===================== MOBILSPESIFIKK STYLING ===================== */
@media (max-width: 768px) {

  /* Video fyller skjermen */
  video {
    width: 100vw;
    height: 100vh;
    object-fit: cover;
  }

  /* Toppbar */
  .top-bar {
    padding: 6px 12px;
  }
  .top-bar img {
    width: 34px;
    height: 34px;
  }

  /* Filmtittel */
  .movie-title {
    font-size: 16px;
    bottom: 70px;
    left: 12px;
  }

  /* Kontroller nederst */
  .controls {
    padding: 8px 10px;
    gap: 12px;
  }

  .center-controls .btn img,
  .left-controls .btn img,
  .right-controls .btn img {
    width: 24px;
    height: 24px;
  }

  /* Like-knapp */
  .like-btn {
    font-size: 14px;
    padding: 6px 10px;
  }

  /* Progress bar */
  .progress-container {
    bottom: 58px;
    padding: 0 10px;
  }

  .progress {
    height: 5px;
  }

  .progress-filled {
    height: 100%;
  }

  .thumb {
    width: 10px;
    height: 10px;
  }

  .time-display {
    font-size: 12px;
    bottom: 70px;
    right: 10px;
  }

  /* Undertekster */
  video::cue,
  .subtitle-overlay {
    font-size: 17px !important;
    bottom: 13% !important;
  }

  .subtitle-overlay.subtitle-up {
    bottom: 22% !important;
  }

  /* Caption-meny */
  .caption-menu {
    right: 10px;
    bottom: 120px;
    min-width: 140px;
  }

  .caption-menu button {
    font-size: 12px;
    padding: 6px 8px;
  }

  /* Fullscreen ikon */
  #fullscreenBtn img {
    width: 28px;
  }

  /* Vannmerke */
  .watermark {
    width: 32px;
    top: 8px;
    right: 8px;
  }

  /* Resume-overlay */
  .resume-box {
    padding: 20px;
  }
  .resume-box p {
    font-size: 16px;
  }
  .resume-buttons button {
    font-size: 14px;
    padding: 8px 16px;
  }

  /* Mini-player */
  .miniplayer {
    width: 240px !important;
    height: 135px !important;
    bottom: 16px;
    right: 16px;
  }
}

/* For veldig sm√• skjermer som iPhone SE */
@media (max-width: 420px) {
  .movie-title {
    font-size: 14px;
    bottom: 64px;
  }

 video::cue {
  font-size: 22px; /* valgfritt */
}

.subtitle-overlay {
  font-size: 22px;
  bottom: 13%;
}

  .subtitle-overlay.subtitle-up {
    bottom: 20% !important;
  }

  .progress-container {
    bottom: 50px;
  }

  .time-display {
    font-size: 11px;
    bottom: 62px;
    right: 8px;
  }

  .controls {
    padding: 6px 8px;
  }

  .center-controls .btn img,
  .left-controls .btn img,
  .right-controls .btn img {
    width: 20px;
    height: 20px;
  }

  .like-btn {
    font-size: 12px;
    padding: 4px 8px;
  }
}

    @media (max-width: 768px) {

  .container {
    width: 100vw;
    height: auto;
    aspect-ratio: 16/9; /* Holder proporsjoner */
    position: relative;
    overflow: hidden;
  }

  video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    position: relative;
  }

  body {
    overflow-y: auto; /* scroll hvis noe er under videoen */
  }
}





  </style>
</head>
<body>
  <div class="container" id="container">
    <video id="video" preload="metadata">
      <source src="" type="video/mp4">
      <track label="Norsk" kind="subtitles" srclang="no" src="" default>
      Din nettleser st√∏tter ikke videoavspilling.
    </video>
    <div class="subtitle-overlay" id="subtitleOverlay"></div>


    <div id="resumeOverlay" class="resume-overlay">
  <div class="resume-box">
    <p>Vil du fortsette der du slapp?</p>
    <div class="resume-buttons">
      <button id="continueBtn">Fortsett</button>
      <button id="restartBtn">Start p√• nytt</button>
    </div>
  </div>
</div>

    <div class="loading-spinner" id="loadingSpinner"></div>

    <div class="preview-box" id="previewBox">
  <img id="previewImage" src="" alt="Preview">
</div>

    <div class="ui" id="ui">
      <div class="top-bar">
        <a href="#" class="back-button" id="backButton">
          <img src="https://static.wixstatic.com/media/fd2fb2_59ea5a2a1ff34303a71a369537dd62c3~mv2.png" alt="Back">
        </a>
      </div>

      <div class="movie-title">The Curse of the Were-Rabbit</div>

      <div class="progress-container">
        <div class="progress" id="progress">
          <div class="progress-filled" id="progressFilled"></div>
          <div class="thumb" id="thumb"></div>
        </div>
      </div>

      <!-- Preview-boksen med bilde + teller -->
      <div class="preview-box" id="previewBox">
       <img id="previewImage" src="" alt="Preview">
        <div class="preview-time" id="previewTime">00:00</div>
       </div>

      
      <span class="time-display" id="timeDisplay">00:00</span>
      
<div class="controls">
  <!-- Venstre (tom her) -->
   <div class="left-controls">
  <button class="btn like-btn">Kanskje du ogs√• vil like?</button>
</div>

  <div class="left-controls"></div>


  <!-- Midten: Rewind - Play/Pause - Forward -->
  <div class="center-controls">
    <button class="btn" id="rewindBtn">
      <img src="https://static.wixstatic.com/media/fd2fb2_a6f7229c8e994a75a12d5849e71156a9~mv2.png" alt="Rewind">
    </button>
    <button class="btn" id="playPauseBtn">
      <img id="playIcon" src="https://static.wixstatic.com/media/fd2fb2_f6f25f56b00e49eea8dc4f811b50bb5c~mv2.png" alt="Play/Pause">
    </button>
    <button class="btn" id="forwardBtn">
      <img src="https://static.wixstatic.com/media/fd2fb2_08262621a72944c498e8124d461ce786~mv2.png" alt="Forward">
    </button>
  </div>

  <!-- H√∏yre: Mute - Captions - Fullscreen -->
  <div class="right-controls">
    <button class="btn" id="muteBtn">
      <img id="muteIcon" src="https://static.wixstatic.com/media/fd2fb2_5c4fab8430e94d2381fc487b1654191d~mv2.png" alt="Mute">
    </button>
    <button class="btn" id="captionsBtn">
      <img src="https://static.wixstatic.com/media/fd2fb2_25072ee44a734507912f0b65f9fc9b0e~mv2.png" alt="Captions">
    </button>
    <button class="btn" id="fullscreenBtn" title="Fullskjerm">
      <img src="https://static.wixstatic.com/media/fd2fb2_3fa37682b3b34c04a2cd08ffcde2763a~mv2.png" alt="Fullscreen">
   
    </button>
  </div>
</div>


      <div class="caption-menu" id="captionMenu">
        <strong>Lydspr√•k</strong>
        <div id="audioTracks"></div>
        <strong>Undertekster</strong>
        <div id="subtitleTracks"></div>
      </div>
    </div>
  </div>

<script src="Filmdata.js"></script>
<script src="Seriedata.js"></script>
<script>
/* ===========================================================
   UNIVERSELL PLAYER ‚Äì FILM + SERIE (BEHOLDER ALL FUNKSJONALITET)
   =========================================================== */

/* ================= URL PARAMS ================= */
const params = new URLSearchParams(window.location.search);

const navn =
  params.get("navn") ||
  params.get("id");

const sesong =
  params.get("sesong") ||
  params.get("s");

const episodeNr =
  params.get("episode") ||
  params.get("e");

/* ================= MEDIA RESOLVE ================= */
let film;        // brukes overalt videre (samme som f√∏r)
let filmId;      // unik ID for localStorage
let type = "film";

if (navn && filmer?.[navn] && !sesong && !episodeNr) {
  /* ===== FILM ===== */
  film = filmer[navn];
  filmId = `film-${navn}`;

} else if (
  navn &&
  serier?.[navn] &&
  sesong &&
  episodeNr &&
  serier[navn].sesonger?.[sesong]?.episoder?.[episodeNr]
) {
  /* ===== SERIE / EPISODE ===== */
  type = "serie";

  const serie = serier[navn];
  const episode = serie.sesonger[sesong].episoder[episodeNr];

  film = {
    ...episode,
    audioLanguages: serie.audioLanguages || [],
    subtitleLanguages: serie.subtitleLanguages || [],
    tilbakeUrl: `serie.html?navn=${navn}`,
    tittel: `${serie.tittel} ‚Äì S${sesong}E${episodeNr}: ${episode.tittel}`
  };

  filmId = `serie-${navn}-s${sesong}-e${episodeNr}`;

} else {
  alert("Ugyldig innhold");
  location.href = "Hovedside.html";
}

/* ================= BASIC SETUP ================= */
document.title = film.tittel;

const video = document.getElementById("video");
video.querySelector("source").src = film.videoUrl;

const track = video.querySelector("track");
if (track && film.subtitleUrl) track.src = film.subtitleUrl;

video.load();

/* ================= DOM ELEMENTS ================= */
const ui = document.getElementById("ui");
const playBtn = document.getElementById("playPauseBtn");
const playIcon = document.getElementById("playIcon");
const muteBtn = document.getElementById("muteBtn");
const muteIcon = document.getElementById("muteIcon");
const rewindBtn = document.getElementById("rewindBtn");
const forwardBtn = document.getElementById("forwardBtn");
const progress = document.getElementById("progress");
const progressFilled = document.getElementById("progressFilled");
const thumb = document.getElementById("thumb");
const timeDisplay = document.getElementById("timeDisplay");
const captionsBtn = document.getElementById("captionsBtn");
const captionMenu = document.getElementById("captionMenu");
const fullscreenBtn = document.getElementById("fullscreenBtn");
const container = document.getElementById("container");
const loadingSpinner = document.getElementById("loadingSpinner");
const previewBox = document.getElementById("previewBox");
const previewImage = document.getElementById("previewImage");
const previewTime = document.getElementById("previewTime");
const subtitleOverlay = document.getElementById("subtitleOverlay");

const resumeOverlay = document.getElementById("resumeOverlay");
const continueBtn = document.getElementById("continueBtn");
const restartBtn = document.getElementById("restartBtn");

/* ================= VARIABLER ================= */
let isDragging = false;
let hideTimeout;
let subtitlesEnabled = true;

/* ================= FUNKSJONER ================= */
function formatTime(t) {
  const m = Math.floor(t / 60);
  const s = Math.floor(t % 60);
  return `${m}:${s < 10 ? "0" + s : s}`;
}

function updateProgress() {
  if (!isDragging) {
    const percent = (video.currentTime / video.duration) * 100;
    progressFilled.style.width = percent + "%";
    thumb.style.left = percent + "%";
  }
  timeDisplay.textContent =
    `${formatTime(video.currentTime)} / ${formatTime(video.duration)}`;

  if (!isNaN(video.duration)) {
    localStorage.setItem(
      "progress_" + filmId,
      ((video.currentTime / video.duration) * 100).toFixed(1)
    );
  }
}

/* ================= EVENTS ================= */
video.addEventListener("timeupdate", updateProgress);
video.addEventListener("loadedmetadata", updateProgress);

playBtn.onclick = () => video.paused ? video.play() : video.pause();
video.onclick = playBtn.onclick;

document.addEventListener("keydown", e => {
  if (e.code === "Space") {
    e.preventDefault();
    playBtn.onclick();
  }
  if (e.key === "ArrowRight") video.currentTime += 10;
  if (e.key === "ArrowLeft") video.currentTime -= 10;
});

video.onplay = () => {
  playIcon.src = "https://static.wixstatic.com/media/fd2fb2_f4658d43d3204506948e5c5ab65461d7~mv2.png";
  showUI();
};
video.onpause = () => {
  playIcon.src = "https://static.wixstatic.com/media/fd2fb2_f6f25f56b00e49eea8dc4f811b50bb5c~mv2.png";
  showUI();
};

muteBtn.onclick = () => {
  video.muted = !video.muted;
  muteIcon.src = video.muted
    ? "https://static.wixstatic.com/media/fd2fb2_e7e7e77a59964f018d9e2d4605a047db~mv2.png"
    : "https://static.wixstatic.com/media/fd2fb2_5c4fab8430e94d2381fc487b1654191d~mv2.png";
};

rewindBtn.onclick = () => video.currentTime = Math.max(0, video.currentTime - 10);
forwardBtn.onclick = () => video.currentTime = Math.min(video.duration, video.currentTime + 10);

/* ================= UI VIS / SKJUL ================= */
function showUI() {
  ui.classList.remove("hidden");
  subtitleOverlay.classList.add("subtitle-up");
  clearTimeout(hideTimeout);
  hideTimeout = setTimeout(() => {
    if (!video.paused) {
      ui.classList.add("hidden");
      subtitleOverlay.classList.remove("subtitle-up");
    }
  }, 3000);
}

document.addEventListener("mousemove", showUI);
document.addEventListener("keydown", showUI);

/* ================= FULLSCREEN ================= */
fullscreenBtn.onclick = () => {
  if (!document.fullscreenElement) container.requestFullscreen();
  else document.exitFullscreen();
};

/* ================= RESUME ================= */
const savedTime = parseFloat(localStorage.getItem(`${filmId}-lastPosition`));

video.addEventListener("loadedmetadata", () => {
  if (!isNaN(savedTime) && savedTime > 10 && video.duration > savedTime) {
    video.currentTime = savedTime;
    resumeOverlay.style.display = "flex";
    continueBtn.onclick = () => {
      resumeOverlay.style.display = "none";
      video.play();
    };
    restartBtn.onclick = () => {
      video.currentTime = 0;
      resumeOverlay.style.display = "none";
      video.play();
    };
  } else {
    video.play().catch(() => {});
  }
});

window.addEventListener("beforeunload", () => {
  localStorage.setItem(`${filmId}-lastPosition`, video.currentTime);
});

video.addEventListener("ended", () => {
  localStorage.removeItem(`${filmId}-lastPosition`);
  localStorage.removeItem("progress_" + filmId);
  localStorage.setItem(`${filmId}-status`, "ferdig");
  window.location.href = film.tilbakeUrl;
});

/* ================= SIKKERHET ================= */
video.addEventListener("contextmenu", e => e.preventDefault());
document.addEventListener("contextmenu", e => e.preventDefault());

</script>




















