<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hovedsiden</title>

  <link rel="icon" type="image/png" href="https://static.wixstatic.com/media/fd2fb2_39376e4ee55b460ab7a3ebbfcf35fef7~mv2.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<style>
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html, body {
  font-family: Arial, sans-serif;
  background: #091B1E;
  color: white;
  overflow-x: hidden;
}

/* Navigasjon til venstre */
.vertical-nav {
  width: 70px;
  height: 100vh;
  background-color: transparent;
  position: fixed;
  top: 0;
  left: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 100;
}

.nav-icons-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.profilmeny {
  cursor: pointer;
  margin-bottom: 10px;
}

.profilmeny img {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid #fff;
}

.nav-icon {
  color: white;
  font-size: 22px;
  padding: 16px 0;
  text-decoration: none;
  text-align: center;
  width: 100%;
  transition: color 0.3s ease;
  cursor: pointer;
  background: none;
  border: none;
}

.nav-icon:hover,
.nav-icon.active {
  color: #00FFCC;
}

/* Hovedinnhold */
main {
  margin-left: 60px;
  padding: 20px 10px 10px 10px;
}

.content-wrapper {
  max-width: 1100px;
  margin: 0 auto;
}

/* === Header PC === */
.top-header {
  display: flex;
  align-items: center;
  width: 100%;
  margin-bottom: 20px;
}

.top-header .watch-logo {
  margin-left: auto;
  width: 200px;
}

.top-header .header-profil {
  display: none;
}

.top-header img.watch-logo {
  width: 200px;
}

/* Hero-banner */
.hero-banner {
  position: relative;
  height: 350px;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 30px;
  margin-left: 16px;
  width: calc(100% - 16px);
  border: 2px solid #00FFCC;
}

.banner-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.banner-content {
  position: absolute;
  top: 50%;
  left: 30px;
  transform: translateY(-50%);
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 10px;
}

.film-logo {
  width: 300px;
}

.watch-button {
  text-decoration: none;
  background-color: white;
  color: black;
  padding: 10px 80px;
  border: none;
  border-radius: 4px;
  font-weight: bold;
  display: inline-block;
}

.watch-button:hover {
  background-color: #f2f2f2;
}

/* === Special Hero Banner med galleri === */
.special-hero-banner {
  margin: 30px 16px;
  width: calc(100% - 32px);
  border: 2px solid #00FFCC;
  border-radius: 12px;
  overflow: hidden;
  position: relative;
  height: 350px;
}

.special-hero-banner .banner-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  filter: brightness(0.6);
}

.banner-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 30px;
  box-sizing: border-box;
}

/* Venstre del */
.banner-left {
  display: flex;
  flex-direction: column;
  gap: 16px;
  z-index: 2;
}

.banner-left .film-logo {
  width: 280px;
  max-width: 100%;
}

.banner-left .watch-button {
  text-decoration: none;
  background: white;
  color: black;
  padding: 12px 40px;
  border-radius: 6px;
  font-weight: bold;
  transition: background 0.3s ease;
}

.banner-left .watch-button:hover {
  background: #f2f2f2;
}

/* Høyre galleri */
.banner-right {
  max-width: 500px;
  overflow-x: auto;
  display: flex;
  gap: 12px;
  padding-bottom: 6px;
}

.banner-gallery {
  display: flex;
  flex-direction: row;
  gap: 12px;
}

.banner-gallery img {
  width: 120px;
  height: 180px;
  object-fit: cover;
  border-radius: 8px;
  transition: transform 0.3s ease;
}

.banner-gallery img:hover {
  transform: scale(1.05);
}

/* Gallerier */
.gallery-section {
  margin-bottom: 20px;
}

.gallery-section h2 {
  font-size: 18px;
  margin-bottom: 12px;
  color: #00FFCC;
  padding-left: 16px;
}

.gallery-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

.fade-left,
.fade-right {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 70px;
  z-index: 1;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.fade-left {
  left: 0;
  background: linear-gradient(to right, #091B1E, rgba(9, 27, 30, 0));
}

.fade-right {
  right: 0;
  background: linear-gradient(to left, #091B1E, rgba(9, 27, 30, 0));
}

.gallery-wrapper:hover .scroll-button:not(.hidden),
.gallery-wrapper:hover .fade-left:not(.fade-hidden),
.gallery-wrapper:hover .fade-right:not(.fade-hidden) {
  opacity: 1;
  pointer-events: auto;
}

.fade-hidden {
  display: none;
}

.scroll-button {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  color: white;
  font-size: 28px;
  cursor: pointer;
  z-index: 2;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  user-select: none;
}

.scroll-button.left {
  left: 0;
}

.scroll-button.right {
  right: 0;
}

.scroll-button.hidden {
  display: none;
}

.scroll-button:hover {
  color: #00FFCC;
}

/* Selve bilde-galleriet */
.image-gallery {
  flex: 1;
  display: flex;
  overflow-x: auto;
  gap: 16px;
  padding: 10px 16px;
  scroll-behavior: smooth;
  -ms-overflow-style: none;
}

.image-gallery::-webkit-scrollbar {
  display: none;
}

.image-gallery a {
  display: inline-block;
  position: relative;
  border-radius: 5px;
  background: transparent;
  overflow: visible;
  border: 2px solid transparent;
  transition: border 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;
}

.image-gallery a img {
  width: 220px;
  height: 124px;
  object-fit: cover;
  border-radius: 5px;
  display: block;
  transition: transform 0.3s ease;
}

.image-gallery a:hover img {
  transform: scale(1.05);
}

/* Fremdriftslinje på filmer */
.image-with-progress {
  position: relative;
  width: 220px;
  height: 124px;
  border-radius: 8px;
  overflow: hidden;
}

.image-with-progress img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.progress-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 4px;
  width: 100%;
  background-color: rgba(255, 255, 255, 0.2);
}

.progress-bar::after {
  content: '';
  position: absolute;
  height: 100%;
  left: 0;
  top: 0;
  background-color: #00FFCC;
  width: var(--progress, 0%);
  transition: width 0.3s ease;
}

/* Footer */
.footer {
  margin-top: 40px;
  padding: 20px 10px;
  text-align: center;
  color: #515151;
  font-size: 14px;
}

.footer-links {
  margin-bottom: 10px;
}

.footer-links a {
  color: #b1b1b1;
  margin: 0 10px;
  text-decoration: none;
  transition: color 0.2s ease;
}

.footer-links a:hover {
  color: #00FFCC;
}

.footer-copy {
  font-size: 13px;
  color: #00FFCC;
}

/* Sjanger-galleri */
.genre-gallery a {
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-width: 160px;
  height: 60px;
  border-radius: 30px;
  background: #0d2c30;
  color: white;
  font-size: 16px;
  font-weight: bold;
  text-decoration: none;
  border: 2px solid transparent;
  transition: all 0.3s ease;
  padding: 0 18px;
}

.genre-gallery a i {
  margin-left: 8px;
  font-size: 18px;
}

.genre-gallery a:hover {
  border: 2px solid #00FFCC;
  box-shadow: 0 0 10px rgba(0, 255, 204, 0.6);
  transform: scale(1.05);
  color: #00FFCC;
}

/* Kommende filmer */
.coming-movies-gallery {
  display: flex;
  flex-direction: row;
  gap: 16px;
  padding: 10px 16px;
  overflow-x: auto;
}

.coming-movie-item {
  display: flex;
  align-items: flex-start;
  gap: 16px;
  background: #0d2c30;
  border-radius: 12px;
  padding: 10px;
  border: 2px solid transparent;
  transition: all 0.3s ease;
  width: 320px;
  cursor: pointer;
  text-decoration: none;
  color: inherit;
}

.coming-movie-item:hover {
  border-color: #00FFCC;
  box-shadow: 0 0 10px rgba(0, 255, 204, 0.4);
  transform: scale(1.03);
}

.coming-movie-item img {
  width: 100px;
  height: 150px;
  object-fit: cover;
  border-radius: 8px;
}

.coming-movie-info {
  display: flex;
  flex-direction: column;
}

.coming-movie-info h3 {
  margin-bottom: 6px;
  font-size: 16px;
  color: #00FFCC;
}

.coming-movie-info p {
  font-size: 14px;
  color: #ccc;
  margin-bottom: 8px;
}

.coming-movie-info .description {
  font-size: 12px;
  color: #999;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* === Topp 10 filmer === */
.top10-gallery {
  display: flex;
  flex-direction: row;
  gap: 30px;
  padding: 10px 16px;
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
}

.top10-gallery::-webkit-scrollbar {
  display: none;
}

.top10-item {
  position: relative;
  display: inline-block;
  border-radius: 8px;
  cursor: pointer;
  transition: transform 0.3s ease;
}

.top10-item img {
  width: 150px;
  height: 225px;
  border-radius: 8px;
  display: block;
}

.top10-item:hover {
  transform: scale(1.05);
}

.top10-number {
  position: absolute;
  bottom: -10px;
  left: -15px;
  font-size: 70px;
  font-weight: 900;
  line-height: 1;
  color: transparent;
  -webkit-text-stroke: 3px #00FFCC;
  z-index: 2;
  transition: all 0.3s ease;
  pointer-events: none;
}

.top10-item:hover .top10-number {
  color: #00FFCC;
  -webkit-text-stroke: 0;
}

/* ===== Mobilvennlig tilpasning ===== */
@media (max-width: 768px) {
  .vertical-nav {
    width: 100%;
    height: 60px;
    flex-direction: row;
    justify-content: space-around;
    position: fixed;
    bottom: 0;
    top: auto;
    background: rgba(9, 27, 30, 0.95);
  }

  .nav-icons-wrapper {
    flex-direction: row;
    gap: 20px;
  }

  .profilmeny {
    margin-bottom: 0;
  }

  .nav-icon {
    font-size: 20px;
    padding: 8px;
  }

  main {
    margin-left: 0;
    margin-bottom: 70px;
    padding: 10px;
  }

  .top-header {
    justify-content: space-between;
  }

  .top-header .watch-logo {
    order: 1;
    width: 140px;
  }

  .top-header .header-profil {
    display: block;
    order: 2;
  }

  .hero-banner {
    height: 200px;
    margin-left: 0;
    width: 100%;
  }

  .film-logo {
    width: 180px;
  }

  .watch-button {
    padding: 8px 30px;
    font-size: 14px;
  }

  .image-gallery a img,
  .image-with-progress {
    width: 160px;
    height: 90px;
  }

  .genre-gallery a {
    min-width: 120px;
    height: 50px;
    font-size: 14px;
    padding: 0 12px;
  }

  .top10-item img {
    width: 140px;
    height: 210px;
  }

  .top10-number {
    font-size: 100px;
  }

  .special-hero-banner {
    height: auto;
  }

  .banner-overlay {
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  .banner-right {
    max-width: 100%;
    justify-content: center;
  }

  .banner-left .film-logo {
    width: 200px;
  }
}

@media (max-width: 480px) {
  .film-logo {
    width: 140px;
  }

  .watch-button {
    padding: 6px 20px;
    font-size: 12px;
  }

  .image-gallery a img,
  .image-with-progress {
    width: 130px;
    height: 72px;
  }

  .genre-gallery a {
    font-size: 12px;
    min-width: 100px;
    height: 44px;
  }

  .footer {
    font-size: 12px;
    padding: 15px 5px;
  }

  .top10-item img {
    width: 120px;
    height: 180px;
  }

  .top10-number {
    font-size: 80px;
  }
}


  </style>
  </head>
  <body>
    <div class="vertical-nav" id="verticalNav">
      <div class="nav-icons-wrapper">
        <div class="profilmeny" onclick="gåTilKonto()">
          <img id="menyProfilbilde" src="https://via.placeholder.com/100" alt="Min profil" />
        </div>
        <a href="Søk.html" class="nav-icon" title="Søk"><i class="fas fa-search"></i></a>
        <a href="Hovedside.html" class="nav-icon active" title="Hjem"><i class="fas fa-house"></i></a>
        <a href="Film.html" class="nav-icon" title="Film"><i class="fas fa-film"></i></a>
        <a href="Serier.html" class="nav-icon" title="Serier"><i class="fas fa-tv"></i></a>
        <a href="Min-Liste.html" class="nav-icon" title="Min liste"><i class="fas fa-bookmark"></i></a>
      </div>
    </div>
  
    <main>
      <div class="content-wrapper">
        <div class="top-header">
          <img class="watch-logo" src="https://static.wixstatic.com/media/fd2fb2_a4b2ace62dff4605a0387f46aad8a404~mv2.png" alt="Watch Logo" />
          <div class="profilmeny header-profil" onclick="gåTilKonto()">
            <img id="headerProfilbilde" src="https://via.placeholder.com/100" alt="Min profil" />
          </div>
        </div>
  
        <!-- Hero Banner -->
        <section class="hero-banner">
          <img class="banner-image" src="" alt="Film Banner">
          <div class="banner-content">
            <img class="film-logo" src="" alt="Film Logo">
          </div>
        </section>
       
        <section class="gallery-section">
          <h2>Nye filmer på Watch</h2>
          <div class="gallery-wrapper">
            <div class="fade-left"></div>
            <button class="scroll-button left" onclick="scrollGallery(this, -1)">❮</button>
            <div class="image-gallery" id="nye-filmer-galleri"></div>
            <button class="scroll-button right" onclick="scrollGallery(this, 1)">❯</button>
            <div class="fade-right"></div>
          </div>
        </section>

        <!-- ===== Fortsett å se ===== -->
<section class="gallery-section" id="fortsett-section" style="display:none;">
  <h2>Fortsett å se</h2>
  <div class="gallery-wrapper">
    <div class="fade-left"></div>
    <button class="scroll-button left" onclick="scrollGallery(this, -1)">❮</button>
    <div class="image-gallery" id="fortsett-galleri"></div>
    <button class="scroll-button right" onclick="scrollGallery(this, 1)">❯</button>
    <div class="fade-right"></div>
  </div>
</section>

  
        <section class="gallery-section">
          <h2>Sjangere</h2>
          <div class="gallery-wrapper">
            <div class="fade-left"></div>
            <button class="scroll-button left" onclick="scrollGallery(this, -1)">❮</button>
            <div class="image-gallery genre-gallery">
              <a href="sjanger.html?navn=barn">Barn / Familie <i class="fas fa-rocket"></i></a>
              <a href="sjanger.html?navn=komedie">Komedie <i class="fas fa-laugh"></i></a>
              <a href="sjanger.html?navn=skrekk">Skrekk <i class="fas fa-ghost"></i></a>
              <a href="sjanger.html?navn=drama">Drama <i class="fas fa-theater-masks"></i></a>
              <a href="sjanger.html?navn=romantikk">Romantikk <i class="fas fa-heart"></i></a>
              <a href="sjanger.html?navn=action">Action <i class="fas fa-bolt"></i></a>
            </div>
            <button class="scroll-button right" onclick="scrollGallery(this, 1)">❯</button>
            <div class="fade-right"></div>
          </div>
        </section>
  
        <section class="gallery-section">
  <h2>Topp 10 filmer nå</h2>
  <div class="gallery-wrapper">
    <div class="fade-left"></div>
    <button class="scroll-button left" onclick="scrollGallery(this, -1)">❮</button>
    <div class="top10-gallery" id="topp10-filmer-galleri"></div>
    <button class="scroll-button right" onclick="scrollGallery(this, 1)">❯</button>
    <div class="fade-right"></div>
  </div>
</section>

  
     <section class="gallery-section">
    <h2>Kommende filmer</h2>
    <div class="gallery-wrapper">
      <div class="fade-left"></div>
      <button class="scroll-button left" onclick="scrollGallery(this, -1)">❮</button>
      <div class="coming-movies-gallery" id="kommer-snart-galleri"></div>
      <button class="scroll-button right" onclick="scrollGallery(this, 1)">❯</button>
      <div class="fade-right"></div>
    </div>
  </section>

<!-- Spesial Halloween-banner -->
<section class="hero-banner special-hero-banner">
  <img class="banner-image" src="https://t3.ftcdn.net/jpg/02/22/61/88/360_F_222618827_0eyqcYch8nDsqVMrEINkppW9iXTZUDXK.jpg" alt="Film Banner" id="special-banner-image">
  <div class="banner-overlay">
    <!-- Venstre side: logo + knapp -->
    <div class="banner-left">
      <img class="film-logo" src="https://disney.images.edge.bamgrid.com/ripcut-delivery/v2/variant/disney/C369F39CA7F3B1EB5BA87B006FB73237CF5FA4AA12FE125BD4E9194F4CE6E16B/compose?format=webp&width=800" alt="Film Logo" id="special-banner-logo">
      <a href="#" class="watch-button" id="special-banner-link">SE MER</a>
    </div>

    <!-- Høyre side: galleri -->
    <div class="banner-right">
      <div class="banner-gallery" id="halloween-gallery"></div>
    </div>
  </div>
</section>

  
        <section class="gallery-section">
          <h2>Barn</h2>
          <div class="gallery-wrapper">
            <div class="fade-left"></div>
            <button class="scroll-button left" onclick="scrollGallery(this, -1)">❮</button>
            <div class="image-gallery" id="barn-galleri"></div>
            <button class="scroll-button right" onclick="scrollGallery(this, 1)">❯</button>
            <div class="fade-right"></div>
          </div>
        </section>
      </div>
  
      <footer class="footer">
        <div class="footer-links">
          <a href="kontakt.html">Kontakt oss</a>
          <a href="personvern.html">Personvern</a>
          <a href="vilkar.html">Vilkår for bruk</a>
          <a href="hjelp.html">Hjelp</a>
        </div>
        <div class="footer-copy">
          © 2025 Watch Nordic Grupe
        </div>
      </footer>
    </main>
  
<script src="Filmdata.js"></script>
<script>
// ==================== AUTENTISERING ==================== //
const epost = localStorage.getItem("epost");
const passord = localStorage.getItem("passord");

if (!epost || !passord) {
  window.location.href = "Starts side.html";
}

window.addEventListener("storage", () => {
  if (!localStorage.getItem("epost") || !localStorage.getItem("passord")) {
    window.location.href = "Starts side.html";
  }
});

// ==================== NAVIGASJON ==================== //
function gåTilKonto() {
  window.location.href = "konto.html";
}

// ==================== PROFILBILDE ==================== //
const lagretBilde = localStorage.getItem("profilbilde");
if (lagretBilde) {
  const menyProfil = document.getElementById("menyProfilbilde");
  if (menyProfil) menyProfil.src = lagretBilde;

  const headerProfil = document.getElementById("headerProfilbilde");
  if (headerProfil) headerProfil.src = lagretBilde;
}

// ==================== HERO-BANNER ==================== //
function oppdaterBanner() {
  // Filtrer ut filmer uten banner
  const filmKeys = Object.keys(filmer).filter(key => filmer[key].banner);

  if (filmKeys.length === 0) return; // ingen filmer med banner

  const randomKey = filmKeys[Math.floor(Math.random() * filmKeys.length)];
  const film = filmer[randomKey];

  const bannerImage = document.querySelector(".hero-banner .banner-image");
  if (bannerImage) {
    bannerImage.src = film.banner;
    bannerImage.alt = film.tittel;
  }

  const bannerLogo = document.querySelector(".hero-banner .film-logo");
  if (bannerLogo) {
    if (film.logo) {
      bannerLogo.src = film.logo;
      bannerLogo.alt = film.tittel + " Logo";
      bannerLogo.style.display = "block";
    } else {
      bannerLogo.style.display = "none";
    }
  }

  const bannerSection = document.querySelector(".hero-banner");
  if (bannerSection) {
    bannerSection.onclick = () => {
      window.location.href = `film.html?navn=${randomKey}`;
    };
  }
}

// ==================== DYNAMISK GALLERI-LASTING ==================== //
function createMovieElement(filmKey, film) {
  const link = document.createElement("a");
  link.href = `film.html?navn=${filmKey}`;
  const img = document.createElement("img");
  img.src = film.poster;
  img.alt = film.tittel;
  link.appendChild(img);
  return link;
}

function createUpcomingMovieElement(filmKey, film) {
  const link = document.createElement("a");
  link.classList.add("coming-movie-item");
  link.href = `film.html?navn=${filmKey}`;

  const poster = document.createElement("img");
  poster.src = film.posterVertikal || film.poster;
  poster.alt = film.tittel;
  link.appendChild(poster);

  const info = document.createElement("div");
  info.classList.add("coming-movie-info");

  const title = document.createElement("h3");
  title.textContent = film.tittel;
  info.appendChild(title);

  const release = document.createElement("p");

  if (film.publishDate) {
    const releaseDate = new Date(film.publishDate);
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    releaseDate.setHours(0, 0, 0, 0);

    const tomorrow = new Date(today);
    tomorrow.setDate(today.getDate() + 1);

    if (releaseDate.getTime() === tomorrow.getTime()) {
      release.textContent = "Kommer i morgen";
    } else {
      const currentYear = today.getFullYear();
      const releaseYear = releaseDate.getFullYear();

      let options = { day: "numeric", month: "long" };
      if (releaseYear !== currentYear) {
        options.year = "numeric";
      }

      const formattedDate = releaseDate.toLocaleDateString("no-NO", options);
      release.textContent = "Kommer: " + formattedDate;
    }
  } else {
    release.textContent = "Kommer: Ukjent";
  }

  info.appendChild(release);
  link.appendChild(info);
  return link;
}

function renderGallery(galleryId, filterFunction, sortByPublishDate = false, limit = null) {
  const gallery = document.getElementById(galleryId);
  if (!gallery) return;

  gallery.innerHTML = "";
  const currentDate = new Date();

  let filmKeys = Object.keys(filmer);

  // Filtrer bort fremtidige filmer
  filmKeys = filmKeys.filter((key) => {
    const film = filmer[key];
    if (!film.publishDate) return true;
    return new Date(film.publishDate) <= currentDate;
  });

  if (filterFunction) {
    filmKeys = filmKeys.filter(filterFunction);
  }

  if (sortByPublishDate) {
    filmKeys.sort((a, b) => {
      const dateA = new Date(filmer[a].publishDate || 0);
      const dateB = new Date(filmer[b].publishDate || 0);
      return dateB - dateA;
    });
  }

  if (limit) {
    filmKeys = filmKeys.slice(0, limit);
  }

  filmKeys.forEach((key) => {
    const film = filmer[key];
    const movieElement = createMovieElement(key, film);
    gallery.appendChild(movieElement);
  });
}

function renderUpcoming(galleryId) {
  const gallery = document.getElementById(galleryId);
  if (!gallery) return;

  gallery.innerHTML = "";
  const currentDate = new Date();

  const upcomingFilms = Object.keys(filmer).filter((key) => {
    const film = filmer[key];
    if (!film.publishDate) return false;
    return new Date(film.publishDate) > currentDate;
  });

  upcomingFilms.sort((a, b) => {
    const dateA = new Date(filmer[a].publishDate);
    const dateB = new Date(filmer[b].publishDate);
    return dateA - dateB;
  });

  upcomingFilms.forEach((key) => {
    const film = filmer[key];
    const element = createUpcomingMovieElement(key, film);
    gallery.appendChild(element);
  });
}

// ==================== TOPP 10 FILMER ==================== //
function renderTop10(galleryId) {
  const gallery = document.getElementById(galleryId);
  if (!gallery) return;

  gallery.innerHTML = "";

  let filmKeys = Object.keys(filmer);

  const today = new Date();

  // --- Fjern filmer som ikke har kommet ennå ---
  filmKeys = filmKeys.filter((key) => {
    const film = filmer[key];
    if (!film.publishDate) return true; 
    return new Date(film.publishDate) <= today;
  });

  // --- Bland rekkefølgen ut fra dagens dato ---
  const seed = today.getFullYear() * 1000 + today.getMonth() * 50 + today.getDate();

  function seededRandom(seed) {
    const x = Math.sin(seed++) * 10000;
    return x - Math.floor(x);
  }

  filmKeys.sort((a, b) => seededRandom(seed + a.length) - seededRandom(seed + b.length));

  // --- Ta kun topp 10 ---
  filmKeys = filmKeys.slice(0, 10);

  // --- Bygg elementene ---
  filmKeys.forEach((key, index) => {
    const film = filmer[key];

    const wrapper = document.createElement("a");
    wrapper.href = `film.html?navn=${key}`;
    wrapper.classList.add("top10-item");

    const img = document.createElement("img");
    img.src = film.posterVertikal || film.poster;
    img.alt = film.tittel;

    const number = document.createElement("div");
    number.classList.add("top10-number");
    number.textContent = index + 1;

    wrapper.appendChild(img);
    wrapper.appendChild(number);
    gallery.appendChild(wrapper);
  });
}

// ==================== SPESIAL HALLOWEEN-BANNER ==================== //
function renderHalloweenBanner() {
  const bannerImage = document.getElementById("special-banner-image");
  const bannerLogo = document.getElementById("special-banner-logo");
  const bannerLink = document.getElementById("special-banner-link");
  const gallery = document.getElementById("halloween-gallery");

  // Finn første film med banner og Halloween/Skrekk metadata
  const halloweenFilmKey = Object.keys(filmer).find(key =>
    filmer[key].banner && filmer[key].metadata.some(m =>
      m.toLowerCase().includes("halloween") || m.toLowerCase().includes("skrekk")
    )
  );

  if (!halloweenFilmKey) return;
  const film = filmer[halloweenFilmKey];

  if (film.banner) bannerImage.src = film.banner;
  if (film.logo) bannerLogo.src = film.logo;
  bannerLink.href = `film.html?navn=${halloweenFilmKey}`;

  gallery.innerHTML = "";
  Object.keys(filmer).forEach(key => {
    const f = filmer[key];
    if (f.banner && f.metadata.some(m =>
      m.toLowerCase().includes("halloween") || m.toLowerCase().includes("skrekk")
    )) {
      const img = document.createElement("img");
      img.src = f.posterVertikal || f.poster;
      img.alt = f.tittel;
      img.onclick = () => window.location.href = `film.html?navn=${key}`;
      gallery.appendChild(img);
    }
  });
}

// ==================== FORTSETT Å SE ==================== //
function renderContinueWatching() {
  const section = document.getElementById("fortsett-section");
  const gallery = document.getElementById("fortsett-galleri");
  if (!section || !gallery) return;

  gallery.innerHTML = "";
  let filmKeys = Object.keys(filmer);

  let fortsettFilmer = filmKeys.filter((key) => {
    const progress = localStorage.getItem("progress_" + key);
    return progress && progress > 0 && progress < 100;
  });

  if (fortsettFilmer.length === 0) {
    section.style.display = "none";
    return;
  }

  section.style.display = "block";

  fortsettFilmer.forEach((key) => {
    const film = filmer[key];
    const progress = localStorage.getItem("progress_" + key);

    const link = document.createElement("a");
    link.href = `film-mal.html?id=${key}`;
    link.classList.add("image-with-progress");

    const img = document.createElement("img");
    img.src = film.poster;
    img.alt = film.tittel;

    const progressBar = document.createElement("div");
    progressBar.classList.add("progress-bar");
    progressBar.setAttribute("data-progress", progress);
    progressBar.style.setProperty("--progress", progress + "%");

    link.appendChild(img);
    link.appendChild(progressBar);
    gallery.appendChild(link);
  });
}

// ==================== INIT ==================== //
document.addEventListener("DOMContentLoaded", () => {
  // Render seksjoner
  renderGallery("nye-filmer-galleri", null, true, 10); 
  renderTop10("topp10-filmer-galleri"); 
  renderGallery("barn-galleri", (key) => {
    const film = filmer[key];
    return film.metadata.some(
      (meta) =>
        meta.toLowerCase().includes("barn") ||
        meta.toLowerCase().includes("familie")
    );
  });
  renderUpcoming("kommer-snart-galleri");
  oppdaterBanner();
  renderHalloweenBanner();
  renderContinueWatching();

  // Galleri-scroll
  document.querySelectorAll(".gallery-wrapper").forEach((wrapper) => {
    const gallery = wrapper.querySelector(".image-gallery, .coming-movies-gallery, .top10-gallery");
    const leftBtn = wrapper.querySelector(".scroll-button.left");
    const rightBtn = wrapper.querySelector(".scroll-button.right");
    const fadeLeft = wrapper.querySelector(".fade-left");
    const fadeRight = wrapper.querySelector(".fade-right");

    function updateScrollState() {
      if (!gallery) return;
      const scrollLeft = gallery.scrollLeft;
      const maxScroll = gallery.scrollWidth - gallery.clientWidth;

      if (leftBtn) leftBtn.classList.toggle("hidden", scrollLeft <= 0);
      if (rightBtn) rightBtn.classList.toggle("hidden", scrollLeft >= maxScroll);
      if (fadeLeft) fadeLeft.classList.toggle("fade-hidden", scrollLeft <= 0);
      if (fadeRight) fadeRight.classList.toggle("fade-hidden", scrollLeft >= maxScroll);
    }

    if (leftBtn) {
      leftBtn.addEventListener("click", () => {
        gallery.scrollBy({ left: -300, behavior: "smooth" });
      });
    }
    if (rightBtn) {
      rightBtn.addEventListener("click", () => {
        gallery.scrollBy({ left: 300, behavior: "smooth" });
      });
    }

    if (gallery) {
      gallery.addEventListener("scroll", updateScrollState);
    }

    updateScrollState();
  });

  // Progress-bar init
  document.querySelectorAll(".progress-bar").forEach((bar) => {
    const progress = bar.getAttribute("data-progress");
    if (progress) {
      bar.style.setProperty("--progress", progress + "%");
    }
  });
});

</script>




















